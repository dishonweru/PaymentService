<?xml version="1.0" encoding="UTF-8"?>
<xml-api xmlns="http://ussd.infobip.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://ussd.infobip.com https://sp.infobip.com/Programmes/USSD/Public/SalesToolkit/API/xml-api-v3.1.xsd">
	<configuration>
		<property name="pageNextMenu" value="#login"/>
		<property name="firstMenuName" value="#login"/>
		<property name="lastMenuName" value="#DefaultExit"/>
		<property name="sessionEndNotificationUrl" value="http://107.174.245.76:8080/ussd/exit"/>
	</configuration>
	<variables>
		<variable name="ussd_title" value="HFC mBanking" />
		<variable name="exit_message" value="Thank you for using HFC mBanking" />
		<variable name="pin_retries" value="0" />
		<variable name="new_pin" value="x" />
		<variable name="accounts" value="0" />
		<variable name="confirm_pin" value="y" />
		<variable name="transactionCharge" value="0" />
		<variable name="transactionTax" value="0" />
		<variable name="serviceSelected" value="" />
		<variable name="endpoint_url" value="http://107.174.245.76:8080/" />
	</variables>
	<messages>
		<input name="login">
			<text>Welcome to ${ussd_title}.Please enter your 4 digit PIN:</text>
			<store-response variable="personalPin"/>
			<ref>#loginSubmit</ref>
		</input>
		<submit name="loginSubmit">
			<method>POST</method>
			<url>${endpoint_url}ussd/stage/3</url>
			<variable>personalPin</variable>
			<variable>pin_retries</variable>
			<variable>new_pin</variable>
			<variable>confirm_pin</variable>
		</submit>
		<input name="wrongpin">
			<text>${pin_retries} tries remaining.Please enter your 4 digit PIN:</text>
			<store-response variable="personalPin"/>
			<ref>#loginSubmit</ref>
		</input>
		<input name="changepin">
			<text>Please enter the preferred new 4 digit PIN:</text>
			<store-response variable="new_pin"/>
			<ref>#confirmChangepin</ref>
		</input>
		<input name="confirmChangepin">
			<text>Re-enter your preferred 4 digit PIN to comfirm:</text>
			<store-response variable="confirm_pin"/>
			<ref>#loginSubmit</ref>
		</input>
		<selection name="services">
			<title>Please Select Your HFC mBanking Service ${first_name}</title>
			<option choice="1" ref="#paybill" text="Pay Bill"/>
			<option choice="2" ref="#airtime_sel" text="Buy Airtime"/>
			<option choice="3" ref="#mpesa_sel" text="M-Pesa"/>
			<option choice="4" ref="#account_sel" text="Check Balance"/>
			<option choice="5" ref="#loans_sel" text="Loans"/>
			<option choice="6" ref="#transfer_sel" text="Funds Transfer"/>
			<option choice="7" ref="#withdrawal" text="Withdraw"/>
			<option choice="8" ref="#myaccount" text="My Account"/>
			<store-option-text variable="serviceSelected" />
			<exit/>
			<remember-history value="true"/>
			<ref>#services</ref>
		</selection>
		<selection name="myaccount">
			<title>Select My Account Service:</title>
			<option choice="1" ref="#account_sel" text="Mini Statement"/>
			<option choice="2" ref="#changepin" text="Change Pin"/>
			<store-option-text variable="serviceSelected" />
			<back/>
			<exit/>
			<remember-history value="true"/>
			<ref>#myaccount</ref>
		</selection>
		<selection name="paybill">
			<title>My Bills:</title>
			<option choice="1" ref="#billAccount" text="New Bill"/>
			<option choice="2" ref="#mybills" text="My Bills"/>
			<back/>
			<exit/>
			<remember-history value="true"/>
			<ref>#paybill</ref>
		</selection>
		<selection name="wrong_service_pin">
			<title>Transaction Failed. Do you want to re-attempt?:</title>
			<option choice="1" ref="#services" text="Yes"/>
			<option choice="2" ref="#DefaultExit" text="No"/>
			<remember-history value="true"/>
			<ref>#wrong_service_pin</ref>
		</selection>
		<input name="billAccount">
			<text>Enter the bill account number</text>
			<store-response variable="bill_account"/>
			<ref>#transactionAmount</ref>
		</input>
		<input name="transactionAmount">
			<text>Enter the bill amount</text>
			<store-response variable="amount"/>
			<ref>#account_sel</ref>
		</input>
		<submit name="serviceSubmit">
			<method>POST</method>
			<url>${endpoint_url}ussd/stage/4</url>
			<variable>personalPin</variable>
			<variable>pin_retries</variable>
			<variable>accountSelected</variable>
			<variable>serviceSelected</variable>
			<variable>bill_account</variable>
			<variable>amount</variable>
		</submit>
		<submit name="fetchCharge">
			<method>POST</method>
			<url>${endpoint_url}ussd/stage/5</url>
			<variable>personalPin</variable>
			<variable>pin_retries</variable>
			<variable>accountSelected</variable>
			<variable>serviceSelected</variable>
		</submit>
		<input name="confirmTransaction">
			<text>${serviceSelected}: Transaction cost ${transactionCharge} Tax ${transactionTax}.Enter your mPIN to proceed </text>
			<store-response variable="personalPin"/>
			<ref>#serviceSubmit</ref>
		</input>
		<submit name="balanceSubmit">
			<method>POST</method>
			<url>${endpoint_url}ussd/stage/4</url>
			<variable>personalPin</variable>
			<variable>pin_retries</variable>
			<variable>accountSelected</variable>
		</submit>
		<selection name="balanceShow">
			<title>${account_balance} .Do you wish to perfrom another transaction?</title>
			<option choice="1" ref="#services" text="Yes"/>
			<option choice="2" ref="#DefaultExit" text="No"/>
			<ref>#balanceShow</ref>
		</selection>
		<bye language="GSM-7" name="DefaultExit">
			<text>Good Bye ${surname}! ${exit_message}.</text>
		</bye>
	</messages>
</xml-api>